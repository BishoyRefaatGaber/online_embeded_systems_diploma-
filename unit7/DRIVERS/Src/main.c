/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2023 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */


#include "STM32F103xx.h"
#include "GPIO.h"
#include "LCD_DRIVER.h"
#include "KEYPAD_DRIVER.h"


GPIO_T *GPIO_A = GPIOA;
GPIO_T *GPIO_B = GPIOB;

GPIO_PinConfig_t PINA_0 ;
GPIO_PinConfig_t PINA_1 ;
GPIO_PinConfig_t PINA_2 ;
GPIO_PinConfig_t PINA_3 ;
GPIO_PinConfig_t PINA_4 ;
GPIO_PinConfig_t PINA_5 ;
GPIO_PinConfig_t PINA_6 ;
GPIO_PinConfig_t PINA_7 ;

GPIO_PinConfig_t PINA_8 ;
GPIO_PinConfig_t PINA_9 ;
GPIO_PinConfig_t PINA_10 ;



GPIO_PinConfig_t PINB_3 ;
GPIO_PinConfig_t PINB_4 ;
GPIO_PinConfig_t PINB_5 ;
GPIO_PinConfig_t PINB_6 ;
GPIO_PinConfig_t PINB_7 ;
GPIO_PinConfig_t PINB_8 ;
GPIO_PinConfig_t PINB_9 ;
GPIO_PinConfig_t PINB_10 ;

void init(){
	RCC_GPIOA_CLK_EN();  //enable GPIO CLOCK
	RCC_GPIOB_CLK_EN();  //enable GPIOB CLOCK
	//=========================
	//LCD PINS
	//=========================
	PINA_0.GPIO_PinNumber = GPIO_PIN_0;
	PINA_0.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_0.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_0);

	PINA_1.GPIO_PinNumber = GPIO_PIN_1;
	PINA_1.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_1.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_1);

	PINA_2.GPIO_PinNumber = GPIO_PIN_2;
	PINA_2.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_2.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_2);

	PINA_3.GPIO_PinNumber = GPIO_PIN_3;
	PINA_3.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_3.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_3);

	PINA_4.GPIO_PinNumber = GPIO_PIN_4;
	PINA_4.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_4.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_4);

	PINA_5.GPIO_PinNumber = GPIO_PIN_5;
	PINA_5.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_5.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_5);

	PINA_6.GPIO_PinNumber = GPIO_PIN_6;
	PINA_6.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_6.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_6);

	PINA_7.GPIO_PinNumber = GPIO_PIN_7;
	PINA_7.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_7.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_7);

	PINA_8.GPIO_PinNumber = GPIO_PIN_8;
	PINA_8.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_8.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_8);

	PINA_9.GPIO_PinNumber = GPIO_PIN_9;
	PINA_9.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_9.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_9);

	PINA_10.GPIO_PinNumber = GPIO_PIN_10;
	PINA_10.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINA_10.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_A , &PINA_10);

	//=========================
	//KEYPAD PINS
	//=========================

	//COLUMNS
	PINB_3.GPIO_PinNumber = GPIO_PIN_3;
	PINB_3.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINB_3.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_3);

	PINB_4.GPIO_PinNumber = GPIO_PIN_4;
	PINB_4.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINB_4.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_4);

	PINB_5.GPIO_PinNumber = GPIO_PIN_5;
	PINB_5.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINB_5.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_5);

	PINB_6.GPIO_PinNumber = GPIO_PIN_6;
	PINB_6.GPIO_MODE = GPIO_MODE_OUTPUT_GENERAL_PUSHPULL;
	PINB_6.GPIO_OUTPUT_SPEED = GPIO_FREQ_10MHZ;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_6);

	//ROWS
	PINB_7.GPIO_PinNumber = GPIO_PIN_7;
	PINB_7.GPIO_MODE = GPIO_MODE_INPUT_PULLUP;
	PINB_7.GPIO_OUTPUT_SPEED = GPIO_FREQ_IN;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_7);

	PINB_8.GPIO_PinNumber = GPIO_PIN_8;
	PINB_8.GPIO_MODE = GPIO_MODE_INPUT_PULLUP;
	PINB_8.GPIO_OUTPUT_SPEED = GPIO_FREQ_IN;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_8);

	PINB_9.GPIO_PinNumber = GPIO_PIN_9;
	PINB_9.GPIO_MODE = GPIO_MODE_INPUT_PULLUP;
	PINB_9.GPIO_OUTPUT_SPEED = GPIO_FREQ_IN;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_9);

	PINB_10.GPIO_PinNumber = GPIO_PIN_10;
	PINB_10.GPIO_MODE = GPIO_MODE_INPUT_PULLUP;
	PINB_10.GPIO_OUTPUT_SPEED = GPIO_FREQ_IN;
	MCAL_GPIO_INIT_PIN(GPIO_B , &PINB_10);

}

void wait_ms(uint32_t time){
	uint32_t i=0,j=0;
	for(; i < time ; i++){
		for (; j < 255 ; j++);
	}
}



int main(void)
{
	init();
	LCD_INIT();
	KEYPAD_INIT();
	uint8_t key;
	while(1){

		key = KEYPAD_GET_CHAR();
		switch( key)
		{
		case  ('\0'): break; //No Key Pressed
		case  ('!'):  LCD_WRITE_COMMAND(LCD_Clear_Display);break;
		default: LCD_WRITE_CHAR(key);break;
		}



	}

	return 0;

}

